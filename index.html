<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>Authentication </title>
  </head>
  <body>
    
    
      <input type="text"  id="first_name" placeholder="First Name" />
    <input type="text"  id="last_name" 
    placeholder="Last Name"/>
    <input type="number" id="age" 
    placeholder="Age"/>
    <input type="email" id="email" placeholder="Email" />
 <input type="password" id="password" 
 placeholder="Password"/>
 <a href="#" onclick="register()">Register </a> 
    
 

<!-- The core Firebase JS SDK is always required and must be listed first -->

<script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>


<!-- TODO: Add SDKs for Firebase products that you want to use
         https://firebase.google.com/docs/web/setup#available-libraries -->
<script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-database.js"></script>

<!-- Our script must be loaded after firebase references -->
<script>

    // Your web app's Firebase configuration

    var firebaseConfig = {
        apiKey: "AIzaSyDWiw0CCkRX7A46q5GQInUbDXjHJt83GHc",
    authDomain: "fir-database-d7776.firebaseapp.com",
    databaseURL: "https://fir-database-d7776-default-rtdb.firebaseio.com",
    projectId: "fir-database-d7776",
    storageBucket: "fir-database-d7776.appspot.com",
    messagingSenderId: "333029624076",
    appId: "1:333029624076:web:07d2b7bb72e2ff64236129",
    measurementId: "G-RD9S0W7KTN"
    };
    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    // Initialize variables
    const auth = firebase.auth()
    const database = firebase.database()

    // Set up our register function
    function register() {
        // Get all our input fields
        email = document.getElementById('email').value
        password = document.getElementById('password').value
        first_name = document.getElementById('first_name').value
        last_name = document.getElementById('last_name').value
        age = document.getElementById('age').value

        // Validate input fields
        if (validate_email(email) == false || validate_password(password) == false) {
            alert('Email or Password is Outta Line!!')
            return
            // Don't continue running the code
        }

        // Move on with Auth
        auth.createUserWithEmailAndPassword(email, password)
            .then(function () {
                // Declare user variable
                var user = auth.currentUser

                // Add this user to Firebase Database
                var database_ref = database.ref()

                // Create User data
                var user_data = {
                    email: email,
                    password: password,
                    full_name: first_name,
                    phone_number: last_name,
                    idpubg: age,
                    last_login: Date.now()
                }

                // Push to Firebase Database
                database_ref.child('users/' + user.uid).set(user_data)

                // DOne
                console.log('User Created!!');
            })
            .catch(function (error) {
                // Firebase will use this to alert of its errors
                var error_code = error.code
                var error_message = error.message

                alert(error_message)
            })
    }

    // Set up our login function
    function login() {
        // Get all our input fields
        email = document.getElementById('email').value
        password = document.getElementById('password').value

        // Validate input fields
        if (validate_email(email) == false || validate_password(password) == false) {
            alert('Email or Password is Outta Line!!')
            return
            // Don't continue running the code
        }

        auth.signInWithEmailAndPassword(email, password)
            .then(function () {
                // Declare user variable
                var user = auth.currentUser

                // Add this user to Firebase Database
                var database_ref = database.ref()

                // Create User data
                var user_data = {
                    last_login: Date.now()
                }

                // Push to Firebase Database
                database_ref.child('users/' + user.uid).update(user_data)

                // DOne
                console.log('User Created!!');

            })
            .catch(function (error) {
                // Firebase will use this to alert of its errors
                var error_code = error.code
                var error_message = error.message

                alert(error_message)
            })
    }




    // Validate Functions
    function validate_email(email) {
        expression = /^[^@]+@\w+(\.\w+)+\w$/
        if (expression.test(email) == true) {
            // Email is good
            return true
        } else {
            // Email is not good
            return false
        }
    }

    function validate_password(password) {
        // Firebase only accepts lengths greater than 6
        if (password < 6) {
            return false
        } else {
            return true
        }
    }

    function validate_field(field) {
        if (field == null) {
            return false
        }

        if (field.length <= 0) {
            return false
        } else {
            return true
        }
    }
</script>

    

  </body>
</html>